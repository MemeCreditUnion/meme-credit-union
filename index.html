<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meme Credit Union</title>
    <!-- Custom CSS is embedded below -->
    
    <style>
        /* GLOBAL STYLES */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f7f9;
            color: #333;
            min-height: 100vh; 
        }

        /* --- FIXED TOP HEADER STYLES (STUCK TO TOP) --- */
        header {
            width: 100%;
            background-color: #ffffff;
            padding: 5px 0; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
            position: fixed; 
            top: 0; 
            left: 0;
            z-index: 1000;
        }

        .header-top-bar {
            max-width: 1200px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between; 
            align-items: center; 
            padding: 0 20px; 
            min-height: 40px; 
        }

        .logo-container img {
            max-height: 60px;
            width: auto;
            display: block; 
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 20px; 
            margin-top: -2px; 
        }

        /* Wallet Connect Button (Now "Login" or truncated address) - Fixed Size */
        .wallet-connect-btn {
            background-color: white; 
            color: #9945FF; 
            border: 2px solid #9945FF; 
            padding: 6px 12px; 
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px; 
            font-weight: bold;
            transition: background-color 0.3s, box-shadow 0.3s, color 0.3s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1); 
            white-space: nowrap; 
            height: 38px; 
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            text-decoration: none; 
        }
        .wallet-connect-btn:hover {
            background-color: #f0f0f0; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }

        /* Connected state styling */
        .wallet-connect-btn.connected {
            background-color: #9945FF; 
            color: white; 
            border-color: #9945FF; 
            padding: 6px 15px;
        }
        .wallet-connect-btn.connected:hover {
            background-color: #8a3be6; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); 
        }

        /* A general action button class based on wallet-connect-btn for use in pages */
        .action-btn {
            background-color: #9945FF; 
            color: white; 
            border: none; 
            padding: 10px 15px; 
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px; 
            font-weight: bold;
            transition: background-color 0.3s, transform 0.1s;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); 
        }
        .action-btn:hover {
            background-color: #8a3be6; 
        }
        .action-btn:active {
            transform: scale(0.98);
        }


        /* --- SOCIAL ICONS --- */
        .social-link {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 38px; 
            height: 38px; 
            border-radius: 50%;
            text-decoration: none;
            transition: background-color 0.2s, box-shadow 0.2s;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1); 
            border: 2px solid #9945FF; 
            background-color: white; 
        }
        .social-link:hover {
            background-color: #f0f0f0; 
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); 
        }

        .social-link svg {
            width: 65%; 
            height: 65%; 
            fill: #9945FF; 
            display: block; 
        }

        /* --- FIXED BOTTOM NAVIGATION STYLES --- */
        nav.bottom-nav {
            width: 100%;
            background-color: #ffffff; 
            padding: 5px 0 5px 0; 
            box-shadow: 0 -2px 5px rgba(0,0,0,0.1); 
            position: fixed;
            bottom: 0;
            left: 0;
            z-index: 1000;
            display: flex;
            justify-content: space-around; 
            align-items: center;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 8px 10px;
            cursor: pointer;
            color: #555; /* Default inactive label color */
            border-radius: 8px;
            transition: background-color 0.2s, color 0.2s;
            flex: 1; 
            max-width: 100px; 
            user-select: none;
        }

        .nav-item:hover {
            background-color: #f0f0f0;
        }

        /* Active State */
        .nav-item.active {
            /* No background change */
        }

        .nav-item.active .nav-label {
            color: #9945FF; /* Highlight label with primary color */
            font-weight: 700;
        }

        .nav-item.active svg {
            stroke: #9945FF;
        }

        .nav-image {
            width: 30px; 
            height: 30px;
            object-fit: contain;
            transition: filter 0.2s;
        }

        .nav-label {
            font-size: 12px;
            font-weight: 600;
            margin-top: 3px;
            color: inherit; /* Inherit from nav-item (default #555) */
            transition: color 0.2s;
        }

        /* --- MAIN CONTENT STYLING --- */
        main {
            max-width: 1200px;
            margin: 0 auto;
            /* Adjust padding to account for fixed header (approx 70px) and footer (approx 50px) */
            padding: 80px 20px 60px 20px; 
            min-height: calc(100vh - 140px); 
            transition: opacity 0.3s ease; 
        }

        .page-header {
            text-align: center;
            padding: 30px 0 20px;
            color: #9945FF;
            border-bottom: 2px solid #eee;
            margin-bottom: 30px;
        }

        .card-container {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
        }

        .info-card {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            text-align: center;
        }
        
        /* Specific card for accent color/highlight */
        .highlight-card {
            background-color: #f0f0ff;
            border: 2px solid #9945FF;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        /* Info card headings color to primary purple */
        .info-card h3 {
            color: #9945FF; 
            margin-top: 0;
        }
        .info-card .apy {
            font-size: 2.2em;
            font-weight: bold;
            color: #9945FF;
            margin: 10px 0;
        }

        /* Flywheel specific styling */
        .flywheel-step {
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 20px;
            border-left: 5px solid #9945FF;
        }
        .flywheel-step h3 {
            color: #333;
            margin-top: 0;
            font-size: 1.5em;
        }
        .flywheel-step ul {
            list-style-type: disc;
            padding-left: 20px;
            margin-top: 10px;
        }
        .flywheel-step li {
            margin-bottom: 8px;
        }
        
        .lending-table-row {
            display: grid;
            grid-template-columns: 1fr 1fr auto;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #eee;
        }
        
        .lending-table-row:last-child {
            border-bottom: none;
        }

        /* Swap specific styles */
        .swap-box {
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }
        .input-group {
            background-color: #f7f7f7;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .input-group input {
            flex-grow: 1;
            background: none;
            border: none;
            font-size: 1.5em;
            font-weight: 600;
            outline: none;
        }
        .input-group select {
            background: none;
            border: none;
            font-size: 1em;
            font-weight: 600;
            padding: 5px;
            cursor: pointer;
            color: #333;
        }
        .swap-divider {
            text-align: center;
            margin: 10px 0;
        }
        .swap-divider button {
            background-color: #e0e0e0;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .swap-divider button:hover {
            background-color: #ccc;
        }
        .swap-divider svg {
            width: 20px;
            height: 20px;
            stroke: #9945FF;
        }


        /* Mobile Responsiveness */
        @media (max-width: 768px) {

            main {
                padding: 90px 10px 60px 10px;
            }

            .header-top-bar {
                flex-direction: row; 
                padding: 10px;
            }

            .header-actions {
                gap: 8px; 
            }

            .wallet-connect-btn {
                padding: 6px 10px; 
                font-size: 13px;
            }

            .card-grid {
                /* Change to single column layout on small screens */
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>

    <header>
        <div class="header-top-bar">
            <div class="logo-container">
                <!-- Logo acts as the Home link -->
                <img src="https://i.ibb.co/Xf9YqQh1/32-A6-E672-0-F20-4-B80-8572-BEB607-F369-E5.png" 
                     alt="Meme Credit Union Logo" 
                     onclick="renderPage('home')" style="cursor: pointer;">
            </div>

            <div class="header-actions">
                <button class="wallet-connect-btn" id="connectWallet" onclick="connectPhantom()">
                    Login
                </button>
                
                <a href="https://twitter.com/MemeCreditUnion" target="_blank" class="social-link" title="Follow us on X">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18.901 1.153h3.684l-8.687 9.873L24 22.846h-6.177l-6.736-8.23-8.156 8.23H.731l9.165-10.42L0 1.153h6.427l5.352 6.574L18.901 1.153Zm-1.547 2.015-1.503-1.464H17.78l-5.776 7.152-1.547 1.954-4.225-5.26-1.547-1.933H3.61l5.228 6.516 1.487 1.879 4.225 5.26h2.176l-5.776-7.152-1.547-1.954L18.354 3.168Z"/>
                    </svg>
                </a>
                
                <a href="https://t.me/MemeCreditUnion" target="_blank" class="social-link" title="Join our Telegram">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M18.384 5.701a.63.63 0 0 0-.847-.074L3.635 12.247a.64.64 0 0 0 .151 1.157l3.636 1.144 9.17-5.908c.114-.078.257-.073.364.013.107.086.13.23.056.347l-7.91 7.224-1.288 3.513a.625.625 0 0 0 .546.853.613.613 0 0 0 .193-.03l3.83-1.42 5.09-3.958 4.225 3.064a.63.63 0 0 0 1.05-.594l-2.062-13.623c-.097-.643-.564-.783-1.076-.66z"/>
                    </svg>
                </a>
            </div>
        </div>
    </header>

    <main id="app-content"></main>

    <nav class="bottom-nav">
        
        <!-- The Home item has been removed as the logo serves this function -->

        <div class="nav-item active" data-page="lending" onclick="renderPage('lending')">
            <img src="https://i.ibb.co/FLrvTmMH/IMG-9842.png" 
                 alt="Lending Icon" 
                 class="nav-image">
            <span class="nav-label">Lending</span>
        </div>

        <div class="nav-item" data-page="dex" onclick="renderPage('dex')">
            <img src="https://i.ibb.co/VcGx1fnB/F842115-C-3-B5-B-44-C1-BF39-2-CD9-C2464-C18.png" 
                 alt="DEX Icon" 
                 class="nav-image">
            <span class="nav-label">DEX</span>
        </div>

        <div class="nav-item" data-page="flywheel" onclick="renderPage('flywheel')">
            <img src="https://i.ibb.co/rffrPDN8/IMG-9841.png" 
                 alt="Flywheel Icon" 
                 class="nav-image">
            <span class="nav-label">Yield</span>
        </div>

        <div class="nav-item" data-page="staking" onclick="renderPage('staking')">
            <img src="https://i.ibb.co/FkZYpbSz/IMG-9840.png" 
                 alt="Staking Icon" 
                 class="nav-image">
            <span class="nav-label">Staking</span>
        </div>
    </nav>

    <!-- Modal Container for Alerts/Confirmation (Hidden by default) -->
    <div id="modal-container" class="hidden fixed inset-0 bg-gray-900 bg-opacity-75 z-[100] flex items-center justify-center p-4" onclick="handleBackdropClick(event)">
        <div id="alert-modal" style="background-color: white; padding: 25px; border-radius: 12px; box-shadow: 0 10px 25px rgba(0,0,0,0.3); width: 100%; max-width: 380px;">
            <h3 id="modal-title" style="font-size: 1.25em; font-weight: bold; margin-bottom: 10px; color: #333;"></h3>
            <p id="modal-message" style="color: #666; margin-bottom: 20px;"></p>
            <!-- Removed the explicit Close button -->
        </div>
    </div>


    <script>
        // --- MOCK PHANTOM INJECTION FOR TESTING ENVIRONMENT ---
        // This object simulates the Phantom wallet provider being injected into the browser window.
        // It allows the connectPhantom function to run without error in the editor.
        if (typeof window.solana === 'undefined') {
            window.solana = {
                isPhantom: true,
                isConnected: false,
                connect: async () => ({
                    publicKey: { toString: () => '9sV8oV9s8nV8s7nW8g2s9V8s3d9a5b3c7d1e8f5g3h2j' } // Mock Public Key
                }),
                on: () => {} // Mock event listener
            };
        }
        
        // --- DOM ELEMENTS AND STATE ---
        const appContent = document.getElementById('app-content');
        const navItems = document.querySelectorAll('.bottom-nav .nav-item');

        // --- WALLET STATE ---
        let walletAddress = null;

        /**
         * Truncates a Solana public key for display.
         * @param {string} key The full public key string.
         * @returns {string} The truncated key.
         */
        function truncateKey(key) {
            if (!key || key.length < 8) return 'N/A';
            return key.substring(0, 4) + '...' + key.substring(key.length - 4);
        }

        /**
         * Updates the text and appearance of both Login buttons.
         */
        function updateWalletUI() {
            const headerButton = document.getElementById('connectWallet');
            // The hero button is dynamic, fetch it every time
            const heroButton = document.getElementById('heroConnectWallet'); 
            
            const buttonText = walletAddress ? truncateKey(walletAddress) : 'Login';
            const className = walletAddress ? 'connected' : '';

            // Update Header Button
            if (headerButton) {
                headerButton.textContent = buttonText;
                // Ensure base classes are preserved
                headerButton.className = 'wallet-connect-btn ' + className; 
            }

            // Update Hero Button (if it exists on the current page)
            if (heroButton) {
                heroButton.textContent = buttonText;
                // Ensure base classes are preserved
                heroButton.className = 'wallet-connect-btn ' + className;
            }
        }
        
        /** Shows a custom modal/alert box. */
        function showModal(title, message) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('modal-container').classList.remove('hidden');
        }

        /** Hides the custom modal/alert box. */
        window.hideModal = function() {
            document.getElementById('modal-container').classList.add('hidden');
        }
        
        /**
         * Handles clicking outside the modal content to dismiss it.
         */
        window.handleBackdropClick = function(event) {
            // Only hide the modal if the click target is the outer container itself
            if (event.target.id === 'modal-container') {
                hideModal();
            }
        }
        
        /**
         * Checks if the user is likely on a mobile device based on screen size.
         * Note: This is a heuristic, not a guaranteed method.
         */
        function isMobileDevice() {
            return window.matchMedia("(max-width: 768px)").matches;
        }


        /**
         * Connects to the Phantom Wallet (or disconnects if already connected).
         */
        window.connectPhantom = async function() {
            if (walletAddress) {
                // If connected, handle disconnection (Phantom usually doesn't need an explicit disconnect call for the wallet object)
                walletAddress = null;
                updateWalletUI();
                console.log('Wallet disconnected (UI update only).');
                alertUserMessage('Wallet disconnected.', 'info');
                return;
            }

            const solana = window.solana;
            
            if (solana && solana.isPhantom) {
                try {
                    console.log('Attempting to connect to Phantom...');
                    // Request connection
                    const resp = await solana.connect();
                    const publicKey = resp.publicKey.toString();
                    
                    walletAddress = publicKey;
                    console.log('Wallet connected:', publicKey);
                    updateWalletUI();
                    alertUserMessage('Wallet connected successfully!', 'success');

                } catch (err) {
                    // Handle rejection or error
                    console.error('Phantom connection failed:', err);
                    alertUserMessage('Wallet connection request rejected or failed. Please try again.', 'error');
                }
            } else {
                // Handle Phantom not found - give better guidance for mobile vs desktop
                console.warn('Phantom wallet provider not found.');
                
                let guidanceMessage = 'Phantom wallet not found. ';

                if (isMobileDevice()) {
                    guidanceMessage += 'For mobile connection, please ensure you open this application within the Phantom mobile app browser.';
                } else {
                    guidanceMessage += 'Please install the Phantom browser extension and refresh the page.';
                }

                alertUserMessage(guidanceMessage, 'warning');
            }
        }

        /**
         * Simple custom message display instead of alert().
         */
        function alertUserMessage(message, type) {
            console.log(`[USER MESSAGE - ${type.toUpperCase()}]: ${message}`);
            
            // Basic UI simulation for feedback
            const messageBar = document.createElement('div');
            messageBar.style.cssText = `
                position: fixed; top: 70px; left: 50%; transform: translateX(-50%); z-index: 2000;
                padding: 10px 20px; border-radius: 8px; font-weight: bold; text-align: center;
                max-width: 90%;
                background-color: ${type === 'error' ? '#f44336' : (type === 'warning' ? '#ff9800' : '#4CAF50')};
                color: white; box-shadow: 0 4px 8px rgba(0,0,0,0.2); transition: opacity 0.5s;
            `;
            messageBar.textContent = message;
            document.body.appendChild(messageBar);

            setTimeout(() => {
                messageBar.style.opacity = 0;
                setTimeout(() => messageBar.remove(), 500);
            }, 5000); // Increased visibility time for reading long guidance messages
        }

        // --- PAGE CONTENT TEMPLATES ---
        const pageContent = {
            home: `
                <section id="hero-new" style="text-align: center; padding: 60px 20px; background-color: white; border-radius: 10px; margin-bottom: 40px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">
                    <h1 style="font-size: 3em; color: #333; margin-bottom: 10px;">Decentralizing Finance.</h1>
                    <p style="font-size: 1.2em; color: #555; margin-bottom: 30px;">Your community-owned, Solana-native protocol for seamless lending, staking, and trading.</p>
                    <button id="heroConnectWallet" class="wallet-connect-btn" 
                       style="background-color: #9945FF; color: white; border-color: #9945FF; padding: 15px 30px; height: auto; display: block; margin: 0 auto; min-width: 150px;">
                       Login
                    </button>
                </section>
                <section id="features-new" style="padding-bottom: 20px;">
                    <h2 style="text-align: center; font-size: 2em; color: #333; margin-bottom: 30px;">Our Four Core Pillars</h2>
                    <div class="card-grid" style="grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));">
                        <div class="info-card"><h3>Lending</h3><p>Earn interest or borrow against your assets.</p></div>
                        <div class="info-card"><h3>DEX</h3><p>Trade tokens with low fees and deep liquidity.</p></div>
                        <div class="info-card"><h3>Flywheel</h3><p>Automated compounding for maximized rewards.</p></div>
                        <div class="info-card"><h3>Staking</h3><p>Secure the protocol and earn governance rewards.</p></div>
                    </div>
                </section>
            `,

            lending: `
                <h1 class="page-header">Lending & Borrowing</h1>
                <section style="text-align: center; padding: 60px 20px; background-color: white; border-radius: 10px; margin-bottom: 40px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">
                    <h2 style="font-size: 2.5em; color: #9945FF; margin-bottom: 15px;">Coming Soon!</h2>
                    <p style="font-size: 1.4em; color: #555; margin-bottom: 30px;">This feature is currently under heavy development.</p>
                    <p style="font-size: 1.1em; color: #777;">We're working hard to bring seamless, high-yield lending and low-cost borrowing to the Meme Credit Union. Follow our X for launch announcements!</p>
                    <div style="margin-top: 30px;">
                        <a href="https://twitter.com/MemeCreditUnion" target="_blank" class="wallet-connect-btn" style="background-color: #9945FF; color: white; border-color: #9945FF; padding: 12px 25px; height: auto; display: inline-flex;">
                            Follow us on X
                        </a>
                    </div>
                </section>
            `,

            dex: `
                <h1 class="page-header">Decentralized Exchange</h1>
                <section style="text-align: center; padding: 40px; background-color: white; border-radius: 10px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">
                    <h2 style="font-size: 1.8em; color: #333; margin-bottom: 30px;">Trade perpetual futures on Solana.</h2>
                    
                    <a href="https://dex.memecreditunion.com" target="_blank" class="wallet-connect-btn" 
                       style="max-width: 250px; width: 80%; background-color: #9945FF; color: white; border-color: #9945FF; padding: 15px 30px; height: auto; font-size: 1.1em; display: block; margin: 0 auto;">
                        Enter DEX Now
                    </a>
                </section>
            `,

            flywheel: `
                <h1 class="page-header">Flywheel Optimization</h1>
                <section style="padding: 20px 0;">
                    <p style="text-align: center; margin-bottom: 30px; font-size: 1.1em; color: #555;">
                        The $MCU Flywheel is designed to generate sustainable yield and grow protocol liquidity through automated strategies.
                    </p>
                    
                    <h2 style="color: #9945FF; margin-bottom: 20px; font-size: 1.8em;">How the Flywheel Works:</h2>
                    
                    <div style="text-align: center; margin-bottom: 30px;">
                        <p style="font-style: italic; color: #9945FF;"></p>
                    </div>

                    <div class="flywheel-step">
                        <h3>1️⃣ Treasury & Yield</h3>
                        <ul>
                            <li><strong>Source:</strong> Creator rewards, LP fees, staked $SOL yield.</li>
                            <li><strong>Action:</strong> Aggregate yields and automatically reinvest them back into the protocol.</li>
                            <li><strong>Impact:</strong> Fuels our next moves and ensures capital efficiency.</li>
                        </ul>
                    </div>

                    <div class="flywheel-step">
                        <h3>2️⃣ Fund pump.fun AMMs</h3>
                        <ul>
                            <li><strong>Strategy:</strong> Pair selection focusing on major tokens and high-potential memes.</li>
                            <li><strong>Execution:</strong> Launch new AMMs (MCU/SOL is already live ✅).</li>
                            <li><strong>Funding:</strong> Seed AMMs with funds from the Treasury and community LP contributions.</li>
                            <li><strong>Growth:</strong> Implement trader & creator incentives to grow liquidity.</li>
                        </ul>
                    </div>

                    <div class="flywheel-step">
                        <h3>3️⃣ Fund Meteora DAMM V2</h3>
                        <ul>
                            <li><strong>Power Source:</strong> Powered by creator rewards + LP + SOL yield.</li>
                            <li><strong>Mechanism:</strong> Utilizes diversified strategies to harvest sustainable returns.</li>
                            <li><strong>Benefit:</strong> DAMM pools actively strengthen liquidity for $MCU.</li>
                        </ul>
                    </div>

                    <div class="flywheel-step">
                        <h3>4️⃣ Governance</h3>
                        <ul>
                            <li><strong>Control:</strong> Community votes on which pools and incentives to prioritize.</li>
                            <li><strong>Oversight:</strong> Continuous monitoring of Total Value Locked (TVL), Impermanent Loss (IL), and overall risk.</li>
                            <li><strong>Transparency:</strong> Transparent reporting + rewards for Liquidity Providers (LPs).</li>
                        </ul>
                    </div>
                    
                    <div style="margin-top: 40px; text-align: center;">
                        <a href="https://dune.com/memecreditunion/flywheel" target="_blank" class="wallet-connect-btn" 
                                style="background-color: #9945FF; color: white; border-color: #9945FF; height: auto; 
                                       padding: 12px 30px; font-size: 1.1em; font-weight: bold; border-radius: 10px; 
                                       box-shadow: 0 3px 8px rgba(153, 69, 255, 0.3); transition: all 0.2s ease-in-out; 
                                       display: inline-flex; /* Use inline-flex for centering flexibility */
                                       margin: 0 auto; max-width: 280px;">
                            Enter the Flywheel
                        </a>
                    </div>
                </section>
            `,

            staking: `
                <h1 class="page-header">$MCU Staking</h1>
                <section id="staking-details" style="text-align: center; padding: 60px 20px; background-color: white; border-radius: 10px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);">
                    <h2 style="font-size: 2.5em; color: #9945FF; margin-bottom: 15px;">Coming Soon!</h2>
                    <p style="font-size: 1.4em; color: #555; margin-bottom: 30px;">This feature is currently under heavy development.</p>
                    <p style="font-size: 1.1em; color: #777;">Soon, you'll be able to stake your $MCU to secure the protocol and earn governance rewards. Follow our X for the latest news!</p>
                    <div style="margin-top: 30px;">
                        <a href="https://twitter.com/MemeCreditUnion" target="_blank" class="wallet-connect-btn" style="background-color: #9945FF; color: white; border-color: #9945FF; padding: 12px 25px; height: auto; display: inline-flex;">
                            Follow us on X
                        </a>
                    </div>
                </section>
            `
        };


        // --- RENDERING FUNCTION ---
        window.renderPage = function(pageId) {
            // 1. Clear and fade out old content
            appContent.style.opacity = 0;
            
            // 2. Set timeout to wait for fade-out, then change content and fade in
            setTimeout(() => {
                const content = pageContent[pageId] || pageContent.home;
                appContent.innerHTML = content;
                updateWalletUI(); // Call again after content changes, especially for the hero button
                appContent.style.opacity = 1;
                updateActiveNavButton(pageId);
                
                // --- POST-RENDER LOGIC ---
                // Attach listener to the dynamically created hero button if it exists
                const heroButton = document.getElementById('heroConnectWallet');
                if (heroButton) {
                    // Re-attaching the global function 'connectPhantom'
                    heroButton.addEventListener('click', connectPhantom); 
                }

            }, 300); // 300ms transition time

            // 3. Scroll to the top of the main content area
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // --- NAVIGATION HIGHLIGHT FUNCTION ---
        function updateActiveNavButton(activePageId) {
            navItems.forEach(item => {
                item.classList.remove('active');
                // Check if the data-page attribute matches the active page ID
                // Note: The 'home' page no longer has an active nav button.
                if (item.dataset.page === activePageId) {
                    item.classList.add('active');
                }
            });
        }

        // --- INITIALIZATION ---
        window.onload = function() {
            // Initial render on load (loads home page content)
            renderPage('home');

            // Attach listener to the static header button
            document.getElementById('connectWallet').addEventListener('click', connectPhantom);

            // Attempt to check if Phantom is already connected on load
            if (window.solana && window.solana.isPhantom && window.solana.isConnected) {
                // In a real app, you'd try to connect passively here. 
            }
        }
    </script>
</body>
</html>

